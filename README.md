## 整体要求
- 系统采用微服务架构，包含1个前端页面服务、4个后端业务服务以及1个微服务网关
- 采用注册中心作为服务注册发现，除前端服务之外，其它服务需要注册到注册中心
- 所有服务采用容器化Docker构建镜像，并部署运行在一个单独的Kubernetes集群里
- 技术选型采用spring cloud开发框架，可选 spring cloud netflix 或者 spring cloud alibaba
- 服务拆分设计参考上图，采用前后端分离设计，后端服务通过网关暴露接口并被前端页面服务访问
- 服务调用设计参考上图，需包含一个多级链路调用的设计，例如图中的 微服务网关->用户服务->推荐服务->歌单服务
- 涉及到算法或具体的业务逻辑部分，设计上尽量简化，例如后端服务上可只设计1到2个接口，不做具体要求
- 用户信息和歌单信息数据存放方式可使用应用内静态json文件方式，数据和图片需要做本地化设计
- 微服务网关可基于开源的Spring Cloud Gateway组件直接使用，无需自行开发

## 功能要求
- 前端页面中包含三个可展示的功能，热门活动展示，推荐歌单展示，全部歌单展示，分别要求如下：
  - 热门活动展示，访问一个外部地址，获取当前推送的活动数据数据，要求外部地址可通过配置文件指定
  - 歌单推荐服务，根据不同的账号登录之后，推荐显示不同的歌单数据，不要求实现真实的推荐算法，可以采用根据用户id取余或者自定义hash算法实现，保证不同用户推荐歌单有差异，要求同一用户推荐歌单不变
- 无需考虑设计用户登录校验，可通过浏览器请求参数传入id模拟当前用户登录状态。例如： http://localhost/ 用户未登录状态的页面（无登录信息，默认推荐歌单） http://localhost?userId=1 用户1的歌单页面（用户1登录信息，用户1推荐歌单） http://localhost?userId=2 用户2的歌单页面（用户2登录信息，用户2推荐歌单）
- 全部歌单列表，不同的账号状态之后，全量的歌单数据是相同的
- 推荐歌单和全部歌单无需全部展示，只展示前4个数据即可
- 进阶需求：外部活动服务可能会模拟出现各种异常（慢响应、错误返回等），请设计熔断或降级机制保证前端页面正常展示
- 进阶需求：前端页面用户可能会出现高频访问，请设计限流机制，当用户信息查询接口请求QPS>1时，提示被限流
- 进阶需求：热门活动依赖的外部服务地址采用K8S CR文件存放，请设计监听CR文件，实时更新外部活动地址，以保证前端页面活动数据是最新的；说明：歌单信息包含歌单名称，歌单图片，播放量三个必要信息

## 非功能性设计需求
1. 基于 Kubernetes 部署，可拆分成不同的部署文件也可以提供一份整合的部署yaml
2. 每个服务都需要配置 liveness 和 readiness 探针检查接口
3. 每个服务都需要配置滚动升级策略，在单pod情况下，执行升级业务流量无损
4. 进阶需求：使用 Prometheus 和 Grafana 处理性能指标数据
5. 进阶需求：使用 Fluentd、ElasticSearch 和 Kibana 管理日志

> 如何基于网关实现应用的灰度发布？
